# AGENTS Instructions for Codex

This repository implements the Agent8 MCP Server in TypeScript. Use this document as a quick reference when working with the code base.

## Development Workflow

- Install dependencies with `pnpm install`.
- Build the project using `pnpm build`.
- Run tests with `pnpm test`.
- Lint with `pnpm lint` or `pnpm lint:fix`.
- Start the server via `pnpm start` or choose the transport with `--transport=<stdio|sse|streamable-http>`.
- Docker builds are available; see `Dockerfile` and `docker-compose.yml` for details.

## Node and Tooling

- Requires Node.js **18.18.0** or higher as specified in `package.json`.
- Uses TypeScript, ESLint, Prettier and Jest. Prettier formatting: 2‑space indentation, single quotes and trailing commas.
- Husky hooks run lint‑staged on commit and execute tests plus a build on push.

## Commit Messages

Follow the conventional format described in `CONTRIBUTING.md` and `.gitmessage`:

```
[type]: Title (max 50 characters)

Body explaining why and what you changed

Footer (optional)
```

Types include `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore` and `perf`.

## PR Guidelines

Pull requests should use `.github/pull_request_template.md` to describe changes and testing. Every PR requires at least one reviewer approval.

## Environment Variables

Environment variables configure transports and tool activation. See `.env.example` for full list. Notable settings:

- `MCP_TRANSPORT` – `stdio`, `sse` or `streamable-http`.
- `PORT` – port for SSE or HTTP transport.
- `LOG_LEVEL`, `LOG_DESTINATION`, `LOG_FILE` for logging.
- API keys for Supabase, OpenAI, fal.ai and Blockade Labs.
- Tool activation flags (`ENABLE_ALL_TOOLS`, `ENABLE_VECTOR_SEARCH_TOOLS`, `ENABLE_ASSET_GENERATE_TOOLS` and more).

Tool activation follows this priority (lower numbers override higher):
1. Individual tool flags (e.g. `ENABLE_CODE_EXAMPLE_SEARCH_TOOL`)
2. Asset type flags (e.g. `ENABLE_IMAGE_GENERATION_TOOLS`)
3. Tool group flags (e.g. `ENABLE_VECTOR_SEARCH_TOOLS`)
4. Global flag `ENABLE_ALL_TOOLS`

Set higher level flags to `false` when enabling only specific tools.

## Features

The server provides:
- Prompt templates, notably `system-prompt-for-agent8-sdk`.
- Vector search tools for code examples and game resources.
- Asset generation tools for images, cinematics, audio and skyboxes.
- UI theme tools.

## Documentation

Game development projects generated by prompts must maintain a `PROJECT.md` file documenting the implementation strategy, features and file structure. Update this file whenever code changes are made.

## Testing & CI

GitHub Actions run lint, build and tests for Node versions 18.x and 20.x. Docker images are built and pushed automatically on `main`.

